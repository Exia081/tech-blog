# 文章目录导航栏功能说明

## 功能概述

为博客文章页面添加了左侧固定目录导航栏（Table of Contents），提供更好的阅读体验。

## 主要特性

### 1. 固定定位，不占用文档流
- 目录使用 `position: fixed` 固定在屏幕左侧
- 不会挤压或影响文章内容的显示宽度
- 文章内容保持原有布局和宽度

### 2. 优雅的切换按钮
- **设计理念**：半隐藏式边缘按钮，不突兀、不干扰阅读
- **位置**：
  - 桌面端：屏幕左侧中间位置，垂直居中
  - 平板/手机：左上角固定位置
- **交互效果**：
  - 默认半透明，融入背景
  - 鼠标悬停时完全显示
  - 图标旋转动画反馈状态变化
  - 悬停显示提示文字（仅桌面端）
- **状态记忆**：使用 localStorage 记住用户的偏好设置
- **智能定位**：
  - 目录显示时：按钮在目录右侧边缘
  - 目录隐藏时：按钮在屏幕左侧边缘

### 3. 智能高亮
- 使用 IntersectionObserver API 监听滚动位置
- 自动高亮当前正在阅读的章节
- 视觉上清晰指示当前位置

### 4. 平滑滚动
- 点击目录链接时，页面会平滑滚动到对应章节
- 提供更好的用户体验

### 5. 响应式设计
- **大屏幕（>1024px）**：目录默认显示在左侧
- **中等屏幕（768-1024px）**：目录默认隐藏，可通过按钮切换
- **小屏幕（<768px）**：
  - 目录以侧边栏形式显示
  - 点击链接后自动关闭
  - 点击目录外部区域也会自动关闭

## 技术实现

### 文件修改

1. **layouts/_default/single.html**
   - 添加目录容器和切换按钮
   - 添加目录显示/隐藏的 JavaScript 逻辑
   - 集成滚动监听和高亮功能

2. **layouts/partials/head.html**
   - 引入新的目录样式文件

3. **assets/toc.css**（新建）
   - 目录导航栏样式
   - 切换按钮样式
   - 响应式布局
   - 深色模式支持

4. **hugo.toml**
   - 配置 Hugo 的目录生成功能
   - startLevel: 2（从 h2 开始）
   - endLevel: 4（到 h4 结束）

## 样式特点

### 目录样式
- 半透明背景，与主题颜色协调
- 圆角设计，现代化外观
- 自定义滚动条样式
- 支持深色模式

### 链接样式
- 默认状态：半透明灰色
- 悬停状态：高亮显示
- 激活状态：蓝色主题色，左侧边框强调

### 切换按钮
- 固定在合适的位置
- 有阴影效果，易于发现
- 悬停时有缩放动画
- 支持深色模式

## 使用说明

### 用户操作
1. 打开任何有标题的文章页面
2. 左上角会显示目录切换按钮（☰）
3. 点击按钮显示/隐藏目录
4. 点击目录中的链接跳转到对应章节
5. 滚动页面时，当前章节会自动高亮

### 配置选项

如需调整目录层级，修改 `hugo.toml`：

```toml
[markup.tableOfContents]
startLevel = 2  # 起始层级（h2）
endLevel = 4    # 结束层级（h4）
ordered = false # 是否使用有序列表
```

### 自定义样式

修改 `assets/toc.css` 可以自定义：
- 目录宽度（默认 280px）
- 位置（默认左侧）
- 颜色主题
- 动画效果

## 浏览器兼容性

- 支持所有现代浏览器
- 使用 IntersectionObserver API（需 Chrome 51+, Firefox 55+, Safari 12.1+）
- localStorage API 用于保存用户偏好
- CSS 变量用于主题颜色

## 注意事项

1. **文章必须有标题**：只有包含 h2-h4 标题的文章才会显示目录
2. **标题需要有 ID**：Hugo 会自动为标题生成 ID
3. **目录为空时不显示**：如果文章没有符合条件的标题，目录和切换按钮都不会显示

## 未来改进

可能的功能增强：
- [ ] 添加目录收起/展开子项功能
- [ ] 支持拖拽调整目录位置
- [ ] 添加目录搜索功能
- [ ] 支持打印时显示目录
- [ ] 添加目录导出功能

